<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Haoyu Wei, Tzujui Liu, Pengxiao Hao, Florian Willomitzer, Oliver Cossairt AbstractMotivated by the need of hologram conservation, we built an end-to-end system that takes as input pictures of hologram">
<meta property="og:type" content="website">
<meta property="og:title" content="Light Field Rendering on 3D Looking Glass Device Tutorial">
<meta property="og:url" content="http://yoursite.com/project/holography">
<meta property="og:site_name" content="Haoyu&#39;s Website">
<meta property="og:description" content="Haoyu Wei, Tzujui Liu, Pengxiao Hao, Florian Willomitzer, Oliver Cossairt AbstractMotivated by the need of hologram conservation, we built an end-to-end system that takes as input pictures of hologram">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/whywww/ImageBed/blob/master/holo.png?raw=true">
<meta property="article:published_time" content="2020-03-23T18:22:03.000Z">
<meta property="article:modified_time" content="2020-05-12T02:04:21.056Z">
<meta property="article:author" content="Haoyu Wei">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/whywww/ImageBed/blob/master/holo.png?raw=true">

<link rel="canonical" href="http://yoursite.com/project/holography">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Light Field Rendering on 3D Looking Glass Device Tutorial | Haoyu's Website
  </title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Haoyu's Website</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-about">

    <a href="/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-projects">

    <a href="/project/" rel="section"><i class="fa fa-fw fa-archive"></i>Projects</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
  
  

          <div class="content">
            

  <div class="posts-expand">
    
    
    
    <div class="post-block" lang="en">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">Light Field Rendering on 3D Looking Glass Device Tutorial
</h1>

<div class="post-meta">
  

</div>

</header>

      
      
      
      <div class="post-body">
          <p>Haoyu Wei, Tzujui Liu, Pengxiao Hao, Florian Willomitzer, Oliver Cossairt</p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>Motivated by the need of hologram conservation, we built an end-to-end system that takes as input pictures of holograms captured from different positions using a handheld device such as a mobile phone and display the reconstructed hologram on a 3D looking glass holographic display device. Concretely, we first expand images of a hologram to a light field with multiplane image scene representation, then we generate the complete light field information needed for the looking glass device to display the reconstructed holograms.</p>
<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><h3 id="Light-Field-Rendering"><a href="#Light-Field-Rendering" class="headerlink" title="Light Field Rendering"></a>Light Field Rendering</h3><p>This part is based on the paper [Mildenhall et al. 2019] (<a href="https://github.com/Fyusion/LLFF" target="_blank" rel="noopener">https://github.com/Fyusion/LLFF</a>)</p>
<ol>
<li>Taking Photos of your object. </li>
</ol>
<p>The guideline is you should use images where the maximum disparity between views is no more than about 64 pixels (watch the closest thing to the camera and don’t let it move more than ~1/8 the horizontal field of view between images). I recommend at least 6 photos and 20-30 images would be the best.</p>
<p><img src="https://github.com/whywww/ImageBed/blob/master/holo.png?raw=true" alt="capguide"></p>
<ol start="2">
<li>System installation &amp; Demo test</li>
</ol>
<p>The instructions by the authors are published on github. Here is the way I’m doing and some supplement. </p>
<p>Clone the repo from github to your working folder. Make sure CUDA, docker and nvidia-docker are installed on your machine. </p>
<p>Run this in the base directory to download a pretrained checkpoint, download a Docker image, and run code to generate MPIs and a rendered output video on an example input dataset:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Download packages.</span></span><br><span class="line">bash download_data.sh</span><br><span class="line">sudo docker pull bmild/tf_colmap</span><br><span class="line">sudo docker tag bmild/tf_colmap tf_colmap</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run docker environment. (Change directories accordingly. Run this every time you restart your docker.)</span></span><br><span class="line">nvidia-docker run -it \</span><br><span class="line">    --rm \</span><br><span class="line">    -v /:/host \</span><br><span class="line">    -v /dir/<span class="keyword">for</span>/harddrive/data:/dir/<span class="keyword">for</span>/data/<span class="keyword">in</span>/docker/environment \</span><br><span class="line">    --workdir /host<span class="variable">$PWD</span> \</span><br><span class="line">    tf_colmap</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run demo in docker</span></span><br><span class="line">bash demo.sh</span><br></pre></td></tr></table></figure>

<p>You should be able to see a video like <a href="https://github.com/Fyusion/LLFF/blob/master/imgs/fern.gif" target="_blank" rel="noopener">this</a> in <code>data/testscene/outputs/test_vid.mp4</code></p>
<p>Troubleshooting:</p>
<ul>
<li><strong>File or dir not found in docker environment:</strong> Check the directories mounted to docker when running the docker environment. Avoid starting docker and running script in the same line. This may cause path confusion in docker environment. </li>
<li><strong>Trouble running demo.sh:</strong> run python scripts line by line in demo.sh, check where the problem is. Or redownload test dataset from <a href="http://people.eecs.berkeley.edu/~bmild/llff/data/testscene.zip" target="_blank" rel="noopener">here</a> to get new update.</li>
</ul>
<ol start="3">
<li>test with your own images.</li>
</ol>
<p>Create a working directory named <code>scenedir</code> for example, and make a data directory named <code>images</code> inside it. Put your photos in <code>images</code>. The <code>scenedir</code> can be renamed as you like and placed in which ever dir path exists in docker. But <code>images</code> folder cannot be renamed.</p>
<p>Check the format of your photos using <code>ll</code> command in linux. Make sure your <code>images</code> dir contains only those images, and they ends with <code>.png, .jpg</code> or <code>.JPG</code> and in the corresponding format. </p>
<p>Note, You can convert image format easily in a linux command, for example:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> *.png; <span class="keyword">do</span> convert <span class="variable">$file</span> <span class="variable">$&#123;file/%.png/.jpg&#125;</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>Now we can write our own bash script and try our photos. Here’s an example of mine.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0,1,2 python imgs2poses.py /host/mnt/scenedir/</span><br><span class="line"></span><br><span class="line">CUDA_VISIBLE_DEVICES=0,1,2 python imgs2mpis.py \</span><br><span class="line">        /host/mnt/scenedir/ \</span><br><span class="line">        /host/mnt/scenedir/mpis_720 \</span><br><span class="line">        --height 720</span><br><span class="line"></span><br><span class="line">mkdir /host/mnt/scenedir/outputs</span><br><span class="line"></span><br><span class="line">python imgs2renderpath.py \</span><br><span class="line">        /host/mnt/scenedir/ \</span><br><span class="line">        /host/mnt/scenedir/outputs/xaxis_path.txt \</span><br><span class="line">        --x_axis</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> cuda_renderer &amp;&amp; make &amp;&amp; <span class="built_in">cd</span> ..</span><br><span class="line"></span><br><span class="line">cuda_renderer/cuda_renderer \</span><br><span class="line">        /host/mnt/scenedir/mpis_720 \</span><br><span class="line">        /host/mnt/scenedir/outputs/xaxis_path.txt \</span><br><span class="line">        /host/mnt/scenedir/outputs/xaxis_vid.mp4 \</span><br><span class="line">        -1 .8 0</span><br></pre></td></tr></table></figure>

<p><code>CUDA_VISIBLE_DEVICES=0,1,2</code> specifies which GPU to use. Other parameters are described in ‘General step-by-step usage’ in the author’s github.</p>
<p>Troubleshooting:</p>
<ul>
<li><strong>PyramidCU::GenerateFeatureList: an illegal memory access was encountered:</strong> Some machine configurations might run into problems running the script imgs2poses.py. Try different GPUs in <code>CUDA_VISIBLE_DEVICES=0,1,2</code>. If the issue persists, try uncommenting <a href="https://github.com/Fyusion/LLFF/blob/master/llff/poses/colmap_wrapper.py#L33" target="_blank" rel="noopener">this line</a> to stop COLMAP from using the GPU to extract image features.</li>
<li><strong>Error running the script:</strong> Check <code>colmap_output.txt</code> in <code>scenedir</code>. If there are images not registered or not paired, it might be the photos do not accord with the guidelines of the system, or image format is incorrect.</li>
</ul>
<ol start="4">
<li>Collect light field images.</li>
</ol>
<p>Here is a python script I wrote to cut all the frames from the video we got.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># <span class="doctag">TODO:</span> Please change the directories</span></span><br><span class="line">outdir = <span class="string">'/Users/haoyuwei/Desktop/splittedvid_lion/'</span></span><br><span class="line">video_dir = <span class="string">'/Users/haoyuwei/mnt/scenedir/outputs/xaxis_vid.mp4'</span></span><br><span class="line"></span><br><span class="line">cap = cv2.VideoCapture(video_dir)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(outdir):</span><br><span class="line">        os.makedirs(outdir)</span><br><span class="line"><span class="keyword">except</span> OSError:</span><br><span class="line">    print(<span class="string">'Error: cannot create dir of output data.'</span>)</span><br><span class="line"></span><br><span class="line">id = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line"></span><br><span class="line">    fn = outdir + str(id) +<span class="string">'.png'</span></span><br><span class="line">    print(<span class="string">'Creating...'</span> + fn)</span><br><span class="line">    cv2.imwrite(fn, frame)</span><br><span class="line"></span><br><span class="line">    id += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>Put images to Looking Glass Device</li>
</ol>
<p>For installation of the Looking Glass Device, please refer to the official documentation <a href="https://docs.lookingglassfactory.com/Gettingstarted/images/Hardware%20Setup%20Guide%20-%20Looking%20Glass%2015-6%20Inch%20Dev%20Kit.pdf" target="_blank" rel="noopener">here</a>. Then, download the HoloPlay Service software <a href="https://lookingglassfactory.com/software/holoplay-service" target="_blank" rel="noopener">here</a> and follow the instruction in the official website <a href="https://docs.lookingglassfactory.com/HoloPlayService/?_ga=2.99792022.987789442.1584998920-1680746765.1570509609" target="_blank" rel="noopener">here</a>. </p>
<p>After you successfully connect the Looking Glass Device, download the <a href="https://lookingglassfactory.com/devtools/lightfield-photo-app" target="_blank" rel="noopener">lightfield photo app</a>. </p>
<p>After installation, navigate to the folder where you installed the app, create a new folder in <strong>Lightfield Photosets</strong>, copy all the light field images we get from the previous step into the folder. Activate the app, then you should see a  new photoset in the app. Click it, then click <strong>choose photos</strong>, and select all the lightfield images in that folder. You should see the images being loaded onto the Looking Glass Device. Click <strong>Set Croping</strong>, and adjust the focus and field of view for best display effects. </p>
<p>For additional informations, please refer to the official documentation in <a href="https://docs.lookingglassfactory.com/LightfieldPhoto/" target="_blank" rel="noopener">here</a>.</p>

      </div>
      
      
      
    </div>
    

    
    
    
  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Abstract"><span class="nav-number">1.</span> <span class="nav-text">Abstract</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Method"><span class="nav-number">2.</span> <span class="nav-text">Method</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Light-Field-Rendering"><span class="nav-number">2.1.</span> <span class="nav-text">Light Field Rendering</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Haoyu Wei"
      src="https://avatars1.githubusercontent.com/u/25973673?s=460&u=564d42f8a7617c5387ed4f68dbf43e05fb629230&v=4">
  <p class="site-author-name" itemprop="name">Haoyu Wei</p>
  <div class="site-description" itemprop="description">Keep MOTIVATED</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">1</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/whywww" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;whywww" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:haoyu.wei97@gmail.com" title="E-Mail → mailto:haoyu.wei97@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/downloads/MyCV.pdf" title="CV → &#x2F;downloads&#x2F;MyCV.pdf"><i class="fa fa-fw fa-paperclip"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Haoyu Wei</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
